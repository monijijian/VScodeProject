## HTML5新属性
1. 标签增删

8个语义元素：header section footer aside nav main article figure
内容元素mark高亮、progress进度
新的表单控件:calander  date  time  email url search
新的input类型：color  date  datetime  email
移除过时标签：big font frame 
2. canvas绘图，支持内联SVG
3. 多媒体 Audio、 Video
4. Web存储 SessionStorage   localStorage
5. HTML5离线web应用，（应用程序缓存）


### 大致流程
1. 在地址栏输入url
2. 浏览器根据DNS查找域名对应的ip地址
3. 浏览器根据ip地址与服务器建立连接
4. 浏览器与服务器通信：浏览器请求，服务器处理请求，浏览器呈现页面


# 从物理设备看
## 构建请求
1. 应用层进行DNS解析
2. 应用层生成http请求报文
3. 传输层建立TCP连接
4. 网络层使用ip地址协议来选择线路
5. 数据链路层实现网络相邻结点的可靠通信
6. 物理层传输数据

## 网络传输
从客户机到服务器要经过许多网络设备
- 集线器 
- 交换机
- 路由器

## 服务器处理及反向运输
服务器接收到比特流 ，把比特流转换成帧格式 ，上传到数据链路层；
服务器检查数据帧的mac地址，与本网卡相同就拆除数据链路层的封装，把数据包上传到网络层
网络层比对ip地址，与本机IP地址相同，拆除网络层的封装，分段上传到传输层
传输层对数据分段进行确认、排序、重组，确保可靠性，再被传到应用层

## 浏览器渲染
浏览器接受通信与服务器相同
1. 如果http响应报文是301或者302 重定向，则浏览器会向响应头中的location再次发送请求
2. 浏览器处理 http响应报文的 主体内容，首先使用loader模块加载相应资源
3. 使用 parse模块 解析HTML、CSS、Javascript资源
4. 构建DOM树、Render树以及RenderLayer树
5. 布局和渲染
6. 硬件加速

### 回流和重排
　回流是指窗口尺寸被修改、发生滚动操作，或者元素位置相关属性被更新时会触发布局过程，在布局过程中要计算所有元素的位置信息。由于HTML使用的是流式布局，如果页面中的一个元素的尺寸发生了变化，则其后续的元素位置都要跟着发生变化，也就是重新进行流式布局的过程，所以被称之为回流

　　前面介绍过渲染引擎生成的3个树：DOM树、Render树、Render Layer树。回流发生在Render树上。常说的脱离文档流，就是指脱离渲染树Render Tree

重绘是指当与视觉相关的样式属性值被更新时会触发绘制过程，在绘制过程中要重新计算元素的视觉息，使元素呈现新的外观

　　由于元素的重绘repaint只发生在渲染层 render layer上。所以，如果要改变元素的视觉属性，最好让该元素成为一个独立的渲染层render layer
下面列举一些减少回流次数的方法

　　（1）不要一条一条地修改DOM样式，而是修改className或者修改style.cssText

　　（2）在内存中多次操作节点，完成后再添加到文档中去

　　（3）对于一个元素进行复杂的操作时，可以先隐藏它，操作完成后再显示

　　（4）在需要经常获取那些引起浏览器回流的属性值时，要缓存到变量中

　　（5）不要使用table布局，因为一个小改动可能会造成整个table重新布局。而且table渲染通常要3倍于同等元素时间

　　此外，将需要多次重绘的元素独立为render layer渲染层，如设置absolute，可以减少重绘范围；对于一些进行动画的元素，可以进行硬件渲染，从而避免重绘和回流



# 相关知识衔接

#### URL
常见的url由 ： 协议名、域名、端口号组成，此外还包含一些路径、查询以及其他片段
通常端口号不常见是因为使用默认端口号，由协议名就能确认端口号
比如http默认端口是80  ，https默认端口443

##### 同源和跨域
同源是浏览器的安全措施，为了保护信息
非同源的限制：
1. Cookie、LocalStorage 和 IndexDB 无法读取。
2. DOM 无法获得。
3. AJAX 请求在浏览器端有跨域限制

#### 缓存
根据是否需要重新向服务器发起请求分为 协商缓存和强缓存
##### 浏览器加载页面资源的简单流程
1. 浏览器先根据这个资源的http头信息来判断是否命中强缓存。如果命中则直接加在缓存中的资源，并不会将请求发送到服务器。
如果未命中强缓存，则浏览器会将资源加载请求发送到服务器。服务器来判断浏览器本地缓存是否失效。若可以使用，则服务器并不会返回资源信息，浏览器继续从缓存加载资源。
如果未命中协商缓存，则服务器会将完整的资源返回给浏览器，浏览器加载新资源，并更新缓存。
##### 强缓存
浏览器会根据资源的http头信息来判断是否命中强缓存，如果命中直接使用强缓存，不再向服务器发送请求
强缓存由http响应头中的  Expires或者Cache-Control  两个字段来控制
1. Expires 

缓存过期时间，是一个绝对时间，所以当浏览器与服务器时间不一致时会导致缓存混乱
2. Cache-Control

是一个相对时间，表示浏览器收到资源后的这一段时间内缓存都可用，由浏览器自己计时

两个字段同时存在时，Cache-Control的优先级更高

##### 协商缓存
如果没能命中强缓存， 浏览器将发送资源请求给服务器， 服务器根据http请求头中的
last-Modify/if-Modify-Since或者Etag/if-None-Match来判断是否命中
命中则返回 304 ，浏览器从缓存中加载资源
##### last-Modify/if-Modify-Since
浏览器请求资源，服务器返回资源的header中会加上last-Modify，表示该资源的最后修改时间
当浏览器再次请求时会再请求头中加上if-Modify-Since，值之前返回的last-Modify，供服务器
判断是否改变，没改变就返回304 使用缓存
缺点：使用最后修改时间来判断资源是否更新，并不准确

##### Etag/if-None-Match
使用方法和last-Modify一样，Etag不是日期而是一个校验码，可以精准的检测资源变化情况


#### TCP三次握手和四次挥手

##### TCP报文中比较重要的字段
Ack(确认号，Ack=Seq+1)、Seq(序号，用来标记发送的字节流)
标志位
URG：紧急指针（urgent pointer）有效。
ACK：确认序号有效。
PSH：接收方应该尽快将这个报文交给应用层。
RST：重置连接。
SYN：发起一个新连接。
FIN：释放一个连接。

三次握手：
客户端发送 SYN=1,Seq=x ,表示想要建立连接
服务器回复：SYN=1,ACK=1,Seq=y,Ack=x+1
浏览器回复：Ack=1;Seq=x+1,Ack=y+1
至此，TCP连接建立成功

为什么进行三次握手？
防止因为回复报文丢失造成 或是 失效的请求报文，服务器开启无用链接增加开销


TCP四次挥手
客户端发送：FIN=1，seq=u
服务器端回复：ACK=1，ack=u+1,seq=v
服务器端发送：FIN=1,ACK=1,ack=u+1,seq=w
客户端回复：ACK=1,ack=w+1,seq=u+1
至此连接断开

为什么握手需要三次，挥手需要四次？
握手之所以需要三次是因为，服务器端的  建立连接请求和确认 放在一次发送
而挥手的 服务器   断开连接请求 和 确认  是分开发送的
为什么要分开发送呀，因为服务器收到请求后并不能立马断开连接由必要的数据需要处理，处理完之后才能
发送断连请求

#### HTTP状态返回码
常见的http状态返回码：
200 服务器成功返回网页   、304使用缓存 、404请求的网页不存在 、 503服务不可用

1. 1xx （临时响应）

100 继续 、101切换协议
2. 2xx （成功）

成功处理了请求的状态码
200成功 、 201已经创建、 202已接受、203非授权、204无内容、205重置内容 、206部分内容
3. 3xx （重定向）

表示要完成请求还需要进一步操作
300多种选择、301永久移动 、302临时移动、303查看其他位置、304使用缓存、305使用代理、307临时重定向
4. 4xx （请求错误）

请求可能出错，妨碍了服务器的处理
400错误请求、401未授权、403服务器解决请求、404找不到、405方法禁用
5. 5xx （服务器错误）

表示服务器在尝试处理请求时发生了内部错误，可能是服务器本身的错误而不是请求出错
500服务器内部错误、501尚未实施、502错误网关、 503服务不可用、504网关超时、505http版本不受支持